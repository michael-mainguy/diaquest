<html>
<!DOCTYPE html>
<html>
<head>
    <script src="/ext/aframe.min.js"></script>
    <script src="/ext/nunjucks.min.js"></script>
    <script src="/ext/aframe-template-component.min.js"></script>
    <script src="/ext/superhands.min.js"></script>
    <script src="/ext/oculus-thumbstick-controls.js"></script>
    <script src="/components/components.js"></script>
    <script src="/components/keyboard.js"></script>
    <script src="/components/thumbstick.js"></script>
    <script src="/components/buttons.js"></script>
    <script src="/components/collider.js"></script>
    <script src="/components/universe.js"></script>
    <script src="/components/debug.js"></script>
    <script src="/components/connector.js"></script>
    <script src="/components/gridLayout.js"></script>
    <script src="/ext/aframe-extras.misc.min.js"></script>
    <script src="/ext/nunjucks.min.js"></script>
    <script src="/ext/aframe-keyboard.js"></script>

</head>
<body>
<script type="module" src="/firebase/firebase.js"></script>
<script src="/components/debug.js"></script>
<!--<script src="/twilio/twilio-video.min.js"></script> -->

<script>
  /*import('../firebase/twilio.js').then((module) => {
        module.connect();
  });
    */

  /*window.addEventListener('load', (event) => {
    const logger = Twilio.Video.Logger.getLogger('twilio-video');
    logger.setLevel('debug');

    fetch("/api/user/profile")
      .then(response =>{
        return response.json();
        })
      .then((profile) => {
        console.log(profile);
      Twilio.Video.createLocalTracks({audio:true, video: false}).then(localTracks => {
        Twilio.Video.connect(profile.twilio_token, {name: 'diaQuest', tracks: localTracks});
      });
    })




  });


*/
</script>


<a-scene buttons stats background="color: #003" fog="type: exponential; color: #fff; near: 20; far: 100">
    <a-assets timeout="20000">
        <img id="skybox" src="./assets/skybox.png">
        <img id="nebula" src="./assets/8192.jpeg">
        <img id="sky2" src="./assets/sky2.jpeg">
        <a-entity id="hud-template" type="text/x-nunjucks-template">
            <a-entity gridlayout position="0 0 0">
                <a-entity position="-.5 .5 0">
                    <a-plane id='edit'
                             color="#ccc" width="1" height="1" position="0 0 -.25"
                             collider="type: create; color: #f00"></a-plane>
                    <a-entity lookatme>
                        <a-box width=".05" height="0.05" depth="0.05" color="#fff"></a-box>
                        <a-box width=".05" position="-.1 0 0" height="0.05" depth="0.05" color="#fff"></a-box>
                        <a-box width=".05" position=".1 0 0" height="0.05" depth="0.05" color="#fff"></a-box>
                    </a-entity>

                </a-entity>
                <a-entity position="-.5 1.5 0">
                    <a-plane id='move'
                             text="value: move" color="#ccc" width="1" height="1" position="0 0 -.25"
                             collider="type: create; color: #f00"></a-plane>
                    <a-entity lookatme>

                        {% for item in [{rotation: "30 30 0"}, {rotation: "39 30 90"}, {rotation: "120 30 0"}] %}
                        <a-entity rotation="{{item.rotation}}">
                            <a-cylinder radius=".01" height="0.3" color="#fff"></a-cylinder>
                            <a-cone color="#fff" radius-bottom="0.03" radius-top="0" height="0.1" position="0 .2 0"
                                    opacity="0.5"></a-cone>
                            <a-cone color="#fff" radius-bottom="0.03" radius-top="0" height="0.1" rotation="0 0 180"
                                    position="0 -.2 0"
                                    opacity="0.5"></a-cone>

                        </a-entity>

                        {% endfor %}


                    </a-entity>

                </a-entity>

                <a-entity position="-1.5 .5 0">
                    <a-plane id='remove'
                             color="#ccc" width="1" height="1" position="0 0 -.25"
                             collider="type: edit; color: #f00"></a-plane>
                    <a-entity lookatme>
                        <a-box width=".2" height="0.05" depth="0.05" color="#f55"></a-box>
                    </a-entity>

                </a-entity>

                <a-entity position=".5 .5 0">
                    <a-plane id='add-universe'
                             color="#ccc" width="1" height="1" position="0 0 -.25"
                             collider="type: create; color: #0f0"></a-plane>
                    <a-sphere color="#aaf"
                              radius="0.25"
                              material="opacity: 0.5">
                        <a-entity lookatme>
                            <a-box width="0.05" height=".2" depth="0.05" color="#5f5"></a-box>
                            <a-box width=".2" height="0.05" depth="0.05" color="#5f5"></a-box>
                        </a-entity>
                    </a-sphere>

                </a-entity>
                <a-entity position=".5 1.5 0">
                    <a-plane id='add-box'
                             color="#ccc" width="1" height="1" position="0 0 -.25"
                             collider="type: create; color: #0f0"></a-plane>
                    <a-box color="#aaf"
                           width="0.25"
                           height="0.25"
                           depth="0.25"
                           material="opacity: 0.5">
                        <a-entity lookatme>
                            <a-box width="0.05" height=".2" depth="0.05" color="#5f5"></a-box>
                            <a-box width=".2" height="0.05" depth="0.05" color="#5f5"></a-box>
                        </a-entity>
                    </a-box>

                </a-entity>

                <a-entity position=".5 -.5 0">
                    <!--animation="property: position; from: 0 -0.625 0; to: 0 0.625 0; loop: true"  -->
                    <a-box color="#aaf"
                           opacity="0.4" width=".4" depth=".05" height=".4">
                        <a-entity lookatme>
                            <a-box width="0.05" height=".2" depth="0.05" color="#5f5"></a-box>
                            <a-box width=".2" height="0.05" depth="0.05" color="#5f5"></a-box>
                        </a-entity>
                    </a-box>
                    <a-plane color="#ccc"
                             id="add-billboard" collider="type: foo; color: #0f0"
                             width="1" height="1" depth="0.1" position="0 0 -.25" id='add-billboard'
                             collider="type: create; color: #0f0"></a-plane>
                </a-entity>
                <a-entity position=".5 -.5 0">
                    <!--animation="property: position; from: 0 -0.625 0; to: 0 0.625 0; loop: true"  -->
                    <a-box color="#aaf"
                           opacity="0.4" width=".4" depth=".4" height=".05">
                        <a-entity lookatme>
                            <a-box width="0.05" height=".2" depth="0.05" color="#5f5"></a-box>
                            <a-box width=".2" height="0.05" depth="0.05" color="#5f5"></a-box>
                        </a-entity>
                    </a-box>
                    <a-plane color="#ccc"
                             id="add-plane" collider="type: foo; color: #0f0"
                             width="1" height="1" depth="0.1" position="0 0 -.25" id='add-billboard'
                             collider="type: create; color: #0f0"></a-plane>
                </a-entity>
                <a-entity position="-.5 -.5 0">
                    <a-entity>
                        <a-plane id='add-connector'
                                 color="#ccc" width="1" height="1" position="0 0 -.25"
                                 collider="type: create; color: #0f0"></a-plane>
                        <!--animation="property: position; from: 0 -0.625 0; to: 0 0.625 0; loop: true"  -->
                        <a-cone color="#aaf" radius-bottom="0.08" radius-top="0" height="0.25" position="0 0.3 0"
                                opacity="0.5"></a-cone>
                        <a-cylinder color="#aaf" radius="0.04"
                                    opacity="0.4" height=".4">
                            <a-entity lookatme>
                                <a-box width="0.05" height=".2" depth="0.05" color="#5f5"></a-box>
                                <a-box width=".2" height="0.05" depth="0.05" color="#5f5"></a-box>
                            </a-entity>
                        </a-cylinder>

                    </a-entity>
                </a-entity>

            </a-entity>
        </a-entity>
        <a-entity id="connector-template" type="text/x-nunjucks-template">

            <a-entity class="data-connector">

                <a-sphere rotation="90 0 0" position="0 0 0" radius="0.04" class="data-packet"
                          color="#f00">

                </a-sphere>
                <a-cylinder collider class="saveable data-direction collidable" rotation="90 0 0" position="0 0 0"
                            material="opacity: 0.5; color: #ccc" transparent="true"
                            height="1" radius="0.05">

                </a-cylinder>
                <a-plane color="#222"
                         lookatme width="1.5" height="0.25"
                         text="color: #fff;  baseline: top; align: center; wrapCount: 20"
                         position="0 0.35 0"></a-plane>
            </a-entity>
        </a-entity>
        <a-entity id="universe" type="text/x-nunjucks-template">
            <a-entity collider grabbable class="saveable">
                <a-sphere animation="property: rotation; from: 0 0 0; to: 0 360 0; loop: true; dur: 60000"
                          class="collidable" material="src: #sky2" color="#77f" radius="0.5"></a-sphere>
                <a-plane color="#222"
                         lookatme width="1.5" height="0.25"
                         text="color: #fff;  baseline: top; align: center; wrapCount: 20"
                         position="0 0.35 0"></a-plane>
            </a-entity>
        </a-entity>
        <a-entity id="box" type="text/x-nunjucks-template">
            <a-entity collider grabbable class="saveable">
                <a-box class="collidable" color="#00f" width=".5" height=".5" depth="0.5"></a-box>
                <a-plane color="#222"
                         lookatme width="1.5" height="0.25"
                         text="color: #fff;  baseline: top; align: center; wrapCount: 20"
                         position="0 0.35 0"></a-plane>
            </a-entity>
        </a-entity>
        <a-entity id="user" type="text/x-nunjucks-template">

            <a-box color="ff0" width=".5" height=".5" depth="0.5"></a-box>

        </a-entity>

        <a-entity id="keys" type="text/x-nunjucks-template">
            <a-sound id="click" src="src: url(/assets/KeyDown.mp3)" autoplay="false"></a-sound>
            <a-plane position="-.01 0 0" color="#eee" key-listen width="1" height="0.2" rotation="0 0 0"
                     text="color: #000; value: test; baseline: center; width: 1;align: center"></a-plane>
            <a-entity position="-.25 -0.125 0" a-keyboard rotation="-10 0 0"></a-entity>
        </a-entity>
    </a-assets>

    <!--<a-entity template="src: #keys" position="0 1.6 13"></a-entity>-->
    <!--<a-entity template="src: #hud-template"  position="1 1 14"></a-entity> -->

    <a-entity>
        <a-cylinder opacity="0.5" height="100" color="#f00" radius="0.01"></a-cylinder>
        <a-cylinder opacity="0.5" height="100" color="#0f0" radius="0.01" rotation="90 0 0"></a-cylinder>
        <a-cylinder opacity="0.5" height="100" color="#00f" radius="0.01" rotation="0 0 90"></a-cylinder>
        <a-sphere opacity="0.2" radius="0.25" color="#ff4"></a-sphere>
    </a-entity>
    <!--<a-entity line="start: -20 0 0; end: 20 0 0; color: red"
              line__2="start: 0 -20 0; end: 0 20 0; color: green"
              line__3="start: 0 0 -20; end: 0 0 20; color: blue"></a-entity> -->
    <a-sphere radius="0.1" id="reticle" position="0 0 0"></a-sphere>
    <a-entity class="rig" position="0 0 14">
        <!--<a-box height="0.1" width="0.1" depth="20"></a-box>-->
        <a-entity
                id="left-hand"
                oculus-touch-controls="hand: left"
                buttons
                mover="forwardback: true; axis: y"
                mover__2="strafe: true; axis: x">
            <a-plane width="0.3"
                     height=".3"
                     color="#fff"
                     id="debug"
                     class="text"
                     text="color: #000; value: test; baseline: center; align: left"
                     position=".1 0.07 0.06"
                     rotation="-70 10 0"></a-plane>
        </a-entity>
        <a-entity id="right-hand"
                  laser-controls
                  raycaster="objects: [collider], .collidable"
                  buttons
                  super-hands sphere-collider="objects: [grabbable]"
                  oculus-touch-controls="hand: right"
                  mover="elevate: true; axis: y"
                  mover__2="turn: true; axis: x">
            <a-plane width="0.2"
                     height="0.03"
                     color="#fff"
                     id="user"
                     user
                     class="text"
                     text="color: #000; value: test; baseline: center; width: 0.25; align: center"
                     position=".1 0.07 0.06"
                     rotation="-70 10 0"></a-plane>
        </a-entity>
        <a-entity camera="active: true" id="camera" position="0 1.6 2">

        </a-entity>
        <a-sound id="ambient" src="src: url(/assets/444.mp3); loop: true; volume=0.3" autoplay="true"
                 position="0 2 5"></a-sound>
    </a-entity>
    <a-entity light="type: ambient; color: #BBB"></a-entity>
    <a-entity light="type: point; color: #FFF; distance: 50; intensity: 1" position="0 0 0"></a-entity>
    <!-- <a-sky src="#nebula" radius="1000" material="fog: false" opacity="0.2"></a-sky> -->
    <!-- <a-sky color="#002" radius="2000" material="fog: false"></a-sky> -->

</a-scene>
</body>
</html>
